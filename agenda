def gera_prompt(dados_aud):
    prompt = f"""
    Você receberá um texto único que contém informações consolidadas, combinando os dados extraídos do arquivo Excel e do relatório de auditoria externa. Esse texto possui a seguinte estrutura:
    [registro constatações KPMG], 
    [registro evidências KPMG], 
    [registro recomendação KPMG], 
    [previsão para implementação], 
    [nome do relatório],
    [relatório auditoria externa]

    Sua tarefa é:

    1. Analisar o relatório contido na seção [relatório auditoria externa] e identificar se:
       - A constatação informada corresponde a: [registro constatações KPMG].
       - A evidência informada corresponde a: [registro evidências KPMG].
       - A recomendação informada corresponde a: [registro recomendação KPMG].
       - A data de implementação presente na constatação confirma: [previsão para implementação].

    2. Quando algum dos itens (constatação ou recomendação) for encontrado, indique onde o auditor poderá localizá-lo (exemplo: “seção X” ou “parágrafo Y”). Utilize itálico para transcrever trechos originais e facilitar a conferência.

    3. Gere resumos concisos para a constatação e para a recomendação, acompanhados de um racional explicativo que detalhe os motivos da sua verificação (conforme informação encontrada ou a falta dela).

    4. Crie um relatório de conferência em HTML, organizando os dados de forma clara e amigável, utilizando elementos como tabelas, cores e formatações que tornem a visualização simples para o auditor. O relatório deve iniciar com o nome do relatório (por exemplo, “CCI BB BI” ou “CCI BB CONSORCIOS”) e conter somente as informações efetivamente encontradas.

    5. Retorne o resultado no seguinte formato JSON (a resposta deve estar em JSON puro, sem qualquer formatação markdown ou trechos de código extra), contendo apenas o atributo "conferencia", conforme o exemplo abaixo:

        {{
          "conferencia": "<html> ... </html>"
        }}

    **Regras Finais Importantes:**
    - Utilize somente as informações extraídas do texto original, evitando inserções genéricas.
    - O JSON final não deve exceder 3.500 tokens.
    - Concentre-se em retornar unicamente o atributo "conferencia", que posteriormente será salvo no banco de dados (Postgres, latin1) e exibido via innerHTML.
    
    **Dados da auditoria externa (KPMG) e do relatório:**
    {dados_aud}
    """
    return prompt
